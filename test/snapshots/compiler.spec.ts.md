# Snapshot report for `test/compiler.spec.ts`

The actual snapshot is saved in `compiler.spec.ts.snap`.

Generated by [AVA](https://avajs.dev).

## Show input Typescript used in tests

> test.ts

    `␊
    type DBTable = ␊
    	| 'block'␊
    	| 'collection'␊
    	| 'space'␊
    ␊
    type RecordPointer<T extends DBTable = DBTable> = T extends 'space' ?␊
    	{ table: T; id: string } :␊
    	{ table: T; id: string; spaceId: string }␊
    ␊
    // Forcing an anonymous type for testing purpose.␊
    type TableModal<T extends DBTable = DBTable> = T extends 'space'␊
    	? { open: false }␊
    	: ({ open: true, view: string } | { open: false })␊
    ␊
    enum AnnotationType {␊
    	Bold,␊
    	Italic,␊
    	Underline,␊
    	Strike,␊
    	Code␊
    }␊
    ␊
    /** Blocks allowed in a document. */␊
    export type DocumentBlock = Text | Table␊
    ␊
    export interface Table {␊
      header: string[]␊
      rows: string[][]␊
    	parent: RecordPointer<'block'>␊
    	/** @deprecated */␊
    	modal: TableModal<'block'>␊
    	rect?: Rect␊
    }␊
    ␊
    export interface Text {␊
      plain: string␊
      annotations: Annotation[]␊
    	rect?: Rect␊
    	toString(): string␊
    }␊
    ␊
    export interface Annotation {␊
      type: AnnotationType␊
      start: number␊
      end: number␊
      unknownData: unknown␊
      anyData: any␊
    }␊
    ␊
    type Position = {␊
    	x: number,␊
    	y: number␊
    	move(dx: number, dy: number): Position␊
    }␊
    ␊
    type Dimension = {␊
    	width: number,␊
    	height: number␊
    	resize(width: number, height: number): Dimension␊
    }␊
    ␊
    type Rect = Position & Dimension␊
    ␊
    /** A persisted document in our database */␊
    export interface Document {␊
    	parent: RecordPointer␊
    	/** Title of the document */␊
      title: string␊
    	/** Author's email */␊
      author: string␊
      body: Array<DocumentBlock>␊
    }␊
    `

## compile-to/python3: compile test.ts to Python with custom declaration routing

> editor/document.py

    `import dataclasses␊
    import typing␊
    import editor.generated␊
    import enum␊
    ␊
    @dataclasses.dataclass␊
    class Document:␊
        parent: typing.Union[editor.generated.DocumentParentSpaceTable, editor.generated.DocumentParentBlockTable, editor.generated.DocumentParentCollectionTable]␊
        title: str␊
        author: str␊
        body: list[DocumentBlock]␊
    ␊
    DocumentBlock = typing.Union[Text, Table]␊
    ␊
    @dataclasses.dataclass␊
    class Text:␊
        plain: str␊
        annotations: list[Annotation]␊
        rect: typing.Optional[editor.generated.Rect]␊
        toString: Callable[[], str]␊
    ␊
    @dataclasses.dataclass␊
    class Annotation:␊
        type: AnnotationType␊
        start: float␊
        end: float␊
        unknownData: object␊
        anyData: typing.Any␊
    ␊
    class AnnotationType(enum.Enum):␊
        Bold = 0␊
        Italic = 1␊
        Underline = 2␊
        Strike = 3␊
        Code = 4␊
    ␊
    @dataclasses.dataclass␊
    class Table:␊
        header: list[str]␊
        rows: list[list[str]]␊
        parent: editor.generated.DocumentParentBlockTable␊
        modal: typing.Union[editor.generated.TableModalOpenTrue, editor.generated.TableModalOpenFalse]␊
        rect: typing.Optional[editor.generated.Rect]`

> editor/document.py.map

    {
      file: 'editor/document.py',
      mappings: ';;;;;AAgEA,C,qBAAA;AAAA;8JAAA;cAAA;eAAA;ACyrCA,e,aAAA,C;;ADluCA,gB,YAAA,C,IAAA,E,KAAA,C;;AAWA,C,qBAAA;AAAA;cAAA;ACutCA,sB,UAAA,CDvtCA;gDAAA;AAIC,2B,GAAA,C;;AAGD,C,qBAAA;AAAA;AA3BA,U,cA2BA;gBAAA;cAAA;uBAAA;;;AA3BA,qB,SAAA;AACC,YADD;AAEC,cAFD;AAGC,iBAHD;AAIC,cAJD;AAKC,Y;;AAMD,C,qBAAA;AAAA;ACguCA,iB,GAAA,CDhuCA;ACguCA,oB,GAAA,EDhuCA;AAlBC,Y,yCAkBD;kGAAA',
      names: [],
      sources: [
        'source 0',
        'source 1',
      ],
      sourcesContent: [
        'source 0: length 1353',
        'source 1: length undefined',
      ],
      version: 3,
    }

> editor/generated.py

    `import dataclasses␊
    ␊
    @dataclasses.dataclass␊
    class DocumentParentSpaceTable:␊
        table: Literal["space"]␊
        id: str␊
    ␊
    @dataclasses.dataclass␊
    class DocumentParentBlockTable:␊
        table: Literal["block"]␊
        id: str␊
        spaceId: str␊
    ␊
    @dataclasses.dataclass␊
    class DocumentParentCollectionTable:␊
        table: Literal["collection"]␊
        id: str␊
        spaceId: str␊
    ␊
    @dataclasses.dataclass␊
    class Rect:␊
        x: float␊
        y: float␊
        move: Callable[[float, float], Position]␊
        width: float␊
        height: float␊
        resize: Callable[[float, float], Dimension]␊
    ␊
    @dataclasses.dataclass␊
    class Position:␊
        x: float␊
        y: float␊
        move: Callable[[float, float], Position]␊
    ␊
    @dataclasses.dataclass␊
    class Dimension:␊
        width: float␊
        height: float␊
        resize: Callable[[float, float], Dimension]␊
    ␊
    @dataclasses.dataclass␊
    class TableModalOpenTrue:␊
        open: True␊
        view: str␊
    ␊
    @dataclasses.dataclass␊
    class TableModalOpenFalse:␊
        open: False`

> editor/generated.py.map

    {
      file: 'editor/generated.py',
      mappings: ';;AAMC,C,qBAAA;AAAA;2BAAA;;;AACA,C,qBAAA;AAAA;2BAAA;WAAA;;;AAAA,C,qBAAA;AAAA;gCAAA;WAAA;;;AAsDD,C,qBAAA;AAAA;YAAA;YAAA;AATC,oB,KAAA,E,KAAA,G,QAAA,CASD;gBAAA;iBAAA;AAHC,sB,KAAA,E,KAAA,G,SAAA,C;;AATD,C,qBAAA;AAAA;YAAA;YAAA;AAGC,oB,KAAA,E,KAAA,G,QAAA,C;;AAGD,C,qBAAA;AAAA;gBAAA;iBAAA;AAGC,sB,KAAA,E,KAAA,G,SAAA,C;;AA9CG,C,qBAAA;AAAA;cAAA;;;AAA+B,C,qBAAA;AAAA',
      names: [],
      sources: [
        'source 0',
      ],
      sourcesContent: [
        'source 0: length 1353',
      ],
      version: 3,
    }

> output count

    2

## compile-to/thrift: Compile test.ts to thrift

> thrift/schema.thrift

    `# No includes␊
    ␊
    namespace * schema␊
    ␊
    /**␊
     * A persisted document in our database␊
     */␊
    struct Document {␊
      0: DocumentParent parent,␊
      /**␊
       * Title of the document␊
       */␊
      1: string title,␊
      /**␊
       * Author's email␊
       */␊
      2: string author,␊
      3: list<DocumentBlock> body␊
    }␊
    ␊
    union DocumentParent {␊
      0: DocumentParentSpaceTable DocumentParentSpaceTable,␊
      1: DocumentParentBlockTable DocumentParentBlockTable,␊
      2: DocumentParentCollectionTable DocumentParentCollectionTable␊
    }␊
    ␊
    struct DocumentParentSpaceTable {␊
      0: /** always "space" */ string table = "space",␊
      1: string id␊
    }␊
    ␊
    struct DocumentParentBlockTable {␊
      0: /** always "block" */ string table = "block",␊
      1: string id,␊
      2: string spaceId␊
    }␊
    ␊
    struct DocumentParentCollectionTable {␊
      0: /** always "collection" */ string table = "collection",␊
      1: string id,␊
      2: string spaceId␊
    }␊
    ␊
    /**␊
     * Blocks allowed in a document.␊
     */␊
    union DocumentBlock {␊
      0: Text Text,␊
      1: Table Table␊
    }␊
    ␊
    struct Text {␊
      0: string plain,␊
      1: list<Annotation> annotations,␊
      2: optional Rect rect␊
    }␊
    ␊
    struct Annotation {␊
      0: AnnotationType type,␊
      1: double start,␊
      2: double end,␊
      3: /** Typescript: unknown */ void unknownData,␊
      4: /** Typescript: any */ void anyData␊
    }␊
    ␊
    enum AnnotationType {␊
      Bold = 0,␊
      Italic = 1,␊
      Underline = 2,␊
      Strike = 3,␊
      Code = 4␊
    }␊
    ␊
    struct Rect {␊
      0: double x,␊
      1: double y,␊
      3: double width,␊
      4: double height␊
    }␊
    ␊
    struct Table {␊
      0: list<string> header,␊
      1: list<list<string>> rows,␊
      2: DocumentParentBlockTable parent,␊
      /**␊
       * @deprecated␊
       */␊
      3: TableModal modal,␊
      4: optional Rect rect␊
    }␊
    ␊
    union TableModal {␊
      0: TableModalOpenTrue TableModalOpenTrue,␊
      1: TableModalOpenFalse TableModalOpenFalse␊
    }␊
    ␊
    struct TableModalOpenTrue {␊
      0: /** always true */ bool open = true,␊
      1: string view␊
    }␊
    ␊
    struct TableModalOpenFalse {␊
      0: /** always false */ bool open = false␊
    }␊
    ␊
    `

> thrift/schema.thrift.map

    {
      file: 'thrift/schema.thrift',
      mappings: ';;;;AAgEA;AAAA;AAAA;AAAA;0BAAA;;;;iBAAA;;;;kBAAA;ACyrCA,U,aAAA,MDzrCA;AAAA,C;;;AA1DC,K,wBAAA,yB;AACA,K,wBAAA,yB;AAAA,K,6BAAA,8B;;;AADA;iDAAA;cAAA;AAAA,C;;AACA;iDAAA;cAAA;mBAAA;AAAA,C;;AAAA;2DAAA;cAAA;mBAAA;AAAA,C;;AAgBD;AAAA;AAAA;AAAA;AAWA,K,IAAA,KAXA;AAEA,K,KAAA,MAFA;AAAA,C;;AAWA;iBAAA;ACutCA,U,UAAA,aDvtCA;uBAAA;AAAA,C;;AAOA;AA3BA,K,cAAA,KA2BA;iBAAA;eAAA;gDAAA;wCAAA;AAAA,C;;AA3BA;AACC,UADD;AAEC,YAFD;AAGC,eAHD;AAIC,YAJD;AAKC,UALD;AAAA,C;;AA+CA;aAAA;aAAA;iBAAA;kBAAA;AAAA,C;;AApCA;ACguCA,U,MAAA,QDhuCA;ACguCA,e,MAAA,ODhuCA;AAlBC,K,wBAAA,OAkBD;;;;qBAAA;uBAAA;AAAA,C;;;AAbI,K,kBAAA,mB;AAA+B,K,mBAAA,oB;;;AAA/B;wCAAA;gBAAA;AAAA,C;;AAA+B;0CAAA;AAAA,C',
      names: [],
      sources: [
        'source 0',
        'source 1',
      ],
      sourcesContent: [
        'source 0: length 1353',
        'source 1: length undefined',
      ],
      version: 3,
    }

> output count

    1

## README example: Typescript to C

> c/types.h

    `typedef struct {␊
      char* name;␊
      Location* workplace;␊
    } TypeA;␊
    ␊
    typedef struct {␊
      int64_t id;␊
      char* title;␊
      char* description;␊
      double lat;␊
      double lng;␊
    } Location;`
